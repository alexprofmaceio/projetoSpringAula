<!DOCTYPE html>
<html lang="pt-br" xmlns:th="http://thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout">
	<head th:replace="fragments/cabecalho :: cabecalho">
		<meta charset="UTF-8">
		<title>Cadastro de Produtos</title>
		<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/css/bootstrap.min.css" integrity="sha384-giJF6kkoqNQ00vy+HMDP7azOuL0xtbfIcaT9wjKHr8RbDVddVHyTfAAsrekwKmP1" crossorigin="anonymous" />
	</head>

	<body>
		<div th:insert="fragments/menu :: menu"></div>	
		<div class="container">
			<div th:switch="${aviso}">
				<div th:case="'sucesso salvar'" class="alert alert-success alert-dismissible fade show" role="alert">Produto salvo com sucesso.</div>
				<div th:case="'erro salvar'" class="alert alert-danger alertdismissible fade show" role="alert">Erro ao salvar produto.</div>
				<div th:case="'sucesso excluir'" class="alert alert-success alert-dismissible fade show" role="alert">Produto excluído com sucesso.</div>
	 			<div th:case="'erro excluir'" class="alert alert-danger alert-dismissible fade show" role="alert">Erro ao excluir produto.</div>
	 		</div>
			<h1>Lista de Produtos</h1>
			<a th:href="@{/}" class="btn btn-primary btn-sm mb-3"> Início </a>
			<a th:href="@{/cadastrarProduto}" class="btn btn-primary btn-sm mb-3"> Novo Produto </a>
			<table border="1" class="table table-striped table-responsive-md">
				<thead>
					<tr>
						<th>Id</th>
						<th>Descrição</th>
						<th>Fornecedor</th>
						<th>Quant</th>
						<th>Valor</th>
						<th>Ações</th>
					</tr>
				</thead>
				<tbody>
					<tr th:if="${produtos} == null">
						<td style="text-align: center;" colspan="6">Não há produtos cadastrados</td>
					<tr th:each="produto : ${produtos}">
						<td th:text="${produto.id}"></td>
						<td th:text="${produto.descricao}"></td>
						<td>
							<p th:each="fn : ${produto.fornecedor}" th:text="${fn.nome}"></p>
						</td>
						<td th:text="${produto.quantidade}"></td>
						<td th:text="${produto.valor}"></td>
						<td>
							<a th:href="@{'/editarProduto/' + ${produto.id}}" class="btn btn-secondary btn-sm mb-3"> Editar </a>
							<a class="btn btn-danger btn-sm mb-3" data-bs-toggle="modal" th:attr="data-bs-target='#modalExcluir' + ${produto.id}"> Excluir </a>							
						</td>
						<!-- MODAL -->
						<div class="modal fade" th:attr="id='modalExcluir' + ${produto.id}" tabindex="-1">
							<div class="modal-dialog">
								<div class="modal-content">
									<div class="modal-header">
										<h5 class="modal-title">Confirmar Exclusão</h5>
										<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="close"></button>
									</div>
									<div class="modal-body">
										<p>Tem certeza que deseja excluir</p>
									</div>
									<div class="modal-footer">
										<button type="button" class="btn btn-secondary btn-sm mb-3" data-bs-dismiss="modal"> Não </button>
										<a th:href="@{'/excluirProduto/' + ${produto.id}}" class="btn btn-danger btn-sm mb-3"> Excluir </a>
									</div>
								</div>
							</div>		
						</div>
						<!-- MODAL -->
					</tr>
				</tbody>
			</table>
		</div>
		<div th:insert="fragments/rodape :: rodape"></div>
		